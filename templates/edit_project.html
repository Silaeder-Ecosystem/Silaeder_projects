<!DOCTYPE html>
<html lang="en ru">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel= "stylesheet" type= "text/css" href= "{{ url_for('static', filename='styles/edit_project.css')}}">
        <link href="https://fonts.cdnfonts.com/css/spoof-trial" rel="stylesheet">
        <title>Silaeder Projects | –í–∏—Ç—Ä–∏–Ω–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤ –°–∏–ª–∞—ç–¥—Ä–∞</title>
    </head>
    <body>
        {% with messages = get_flashed_messages() %}
            {% if messages %}
                {% for message in messages %}
                    <script>alert("{{message}}");</script>
                {% endfor %}
            {% endif %}
        {% endwith %}
        <header class="site-header">
            <nav class="site-navigation">
                <img src="{{ url_for('static', filename='icon.jpg')}}" class="logo">
                <span class="name"><a href="/">Silaeder Projects</a></span>
                <input name="search" type="text" class="search" placeholder="Search..."  id="search">
                <div class="dropdown">
                    <span>üë§</span>                  
                    <div class="dropdown-content">
                        <a href="/myprojects/new">Create project</a>
                        <a href="/myprojects">My projects</a>
                        <a href="/logout" style="color: red;">Log Out</a>
                    </div>
                </div>
            </div>
            </nav>
        </header>
        <div class="form">
            <form action="/projects/{{ans[0]}}/edit" method="post" enctype="multipart/form-data">
                <span class="titles">–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞: </span>
                <input type="text" name="name" id="name" class="input-text" placeholder="Title" value="{{ans[2]}}">
                <br>    
                <span class="titles">–ù–∞—É—á–Ω—ã–π —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å(–∏–ª–∏ —Å–ª–æ–≤–æ '–Ω–µ—Ç', –µ—Å–ª–∏ –Ω–µ—Ç): </span>
                <input type="text" name="teacher" id="teacher" class="input-text" placeholder="Name" value="{{ans[-4]}}">
                <br>  
                <span class="titles">–¢–µ–º–∞ –ø—Ä–æ–µ–∫—Ç–∞: </span>
                <input type="text" name="topic" id="topic" class="input-text" placeholder="Name" value = '{{ans[-5]}}'>
                <br>
                <span class="titles">–£—á–∞—Å—Ç–Ω–∏–∫–∏: </span>
                <ul id="collaborators">
                    {% for i in ans[1] %}
                    	<li onclick="remove(this)"><input class="hid_inp" name="collaborators[]" value='{{i}}'></input>{{i}}</li>
                    {% endfor %}
                    <li id="addNewContext" class="menu-item-divided">+</li>
                </ul> 
                <br>  
                <span class="titles">–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞: </span>
                <textarea type="text" name="description" id="description" class="input-text" placeholder="Something">{{ans[3]}}</textarea>
                <br> 
                <span class="titles">–û–±–ª–æ–∂–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞: </span>            
                <br>
                <div class="cover">
                    <label for="cover" class="input-file-label">Choose file</label>
                    <input type="file" name="cover" id="cover" class="input-file" value="{{url_for('static', filename='ans[-3]')}}">    
                    <output id="list"></output>
                </div>
                <br>
                <span class="titles">–°—Å—ã–ª–∫–∞ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∏(–∏–ª–∏ –æ—Å—Ç–∞–≤—Ç–µ –ø—É—Å—Ç—ã–º, –µ—Å–ª–∏ –Ω–µ—Ç): </span>
                <input type="text" name="link-image" id="link-image" class="input-text" placeholder="Link" value = '{{ans[4]}}'>
                <br> 
                <span class="titles">–°—Å—ã–ª–∫–∞ –Ω–∞ PGF –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é(–∏–ª–∏ –æ—Å—Ç–∞–≤—Ç–µ –ø—É—Å—Ç—ã–º, –µ—Å–ª–∏ –Ω–µ—Ç): </span>
                <input type="text" name="link-pdf" id="link-pdf" class="input-text" placeholder="Link" value='{{ans[-1]}}'>
                <br>
                <span class="titles">–°—Å—ã–ª–∫–∞ –Ω–∞ –≤–∏–¥–µ–æ(–∏–ª–∏ –æ—Å—Ç–∞–≤—Ç–µ –ø—É—Å—Ç—ã–º, –µ—Å–ª–∏ –Ω–µ—Ç): </span>
                <input type="text" name="link-video" id="link-video" class="input-text" placeholder="Link" value = '{{ans[5]}}'>
                <br>
                <span class="titles">–ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏(–∏–ª–∏ –æ—Å—Ç–∞–≤—Ç–µ –ø—É—Å—Ç—ã–º, –µ—Å–ª–∏ –Ω–µ—Ç): </span>
                <input type="text" name="link-interes" id="link-interes" class="input-text" placeholder="Link, link, ..." value = '{{ans[-2]}}'>
                <br>
                <input type="submit" name="submit" id="submit" value="Submit">
                <a href="/myprojects" class="cancel">Cancel</a>
                <a href="/projects/{{id}}/delete" class="cancel">Delete</a>
            </form>
        </div>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
        <script>

            $('#addNewContext')

            .click(function() {
                $(this).html("").attr('contenteditable', 'true');
            })

            .keyup(function(e) {
            if (e.keyCode == 13) {
                var val = $(this).text();
                $(this)
                    .before('<li onclick="remove(this)"><input class="hid_inp" name="collaborators[]" value="'+ val + '" readonly>' + val + '</input></li>')

                    .html("+")

                    .attr('contenteditable', 'false');
                e.preventDefault();
            }
            });

            function remove(el) {
                var element = el;
                element.remove();
            }

            function handleFileSelect (evt) {
                for (const file of evt.target.files) {
                
                    const span = document.createElement('span')
                    const src = URL.createObjectURL(file)
                    span.innerHTML = 
                    `<img style="height: 75px; border: 1.5px solid #edd200; border-radius: 7px; margin: 5px"` + 
                    `src="${src}" title="${escape(file.name)}">`

                    document.getElementById('list').insertBefore(span, null)
                }
            }

            document.getElementById('cover').addEventListener('change', handleFileSelect, false);
        </script>
    </body>
</html>
